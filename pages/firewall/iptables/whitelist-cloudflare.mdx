# IPTables Restrict Traffic to Only Cloudflare

Run the following script:
```bash filename="cffw.sh" copy
#!/bin/sh

curl -s https://www.cloudflare.com/ips-v4 -o /tmp/cf_ips
echo "" >> /tmp/cf_ips
curl -s https://www.cloudflare.com/ips-v6 >> /tmp/cf_ips

# Allow all traffic from Cloudflare IPs (no ports restriction)
for cfip in $(cat /tmp/cf_ips); do
  iptables -A INPUT -p tcp -s $cfip --dport 80 -j ACCEPT -m comment --comment "Cloudflare IP"
  iptables -A INPUT -p tcp -s $cfip --dport 443 -j ACCEPT -m comment --comment "Cloudflare IP"
done

iptables-save > /etc/iptables/rules.v4
ip6tables-save > /etc/iptables/rules.v6
```